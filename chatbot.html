<!DOCTYPE html>
<html lang='en'>

<head>
    <meta charset='UTF-8'>
    <meta name='viewport' content='width=device-width, initial-scale=1.0'>
    <meta http-equiv='X-UA-Compatible' content='ie=edge'>
    <link rel='stylesheet' href='assets/style/main.css'>
    <title>POLICE - Training BOT</title>
</head>

<body>
    <div class="chat-container">
        <div class="chatroom open">
            <h3>Police training chatbot</h3>
            <div class="chats" id="chats">
                <li class="chat nar">
                    <div class="text">
                        <span>She enters the room, her eyes are red, she looks briefly in your direction</span>
                    </div>
                </li>
            </div>
            <div class="input">
                <input type="text" value="" id="text">
                <input type="submit" value="Submit" id="submit">
                <button type="button" id="speech-input">
                    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 352 512"
                        class="vertical-center" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg">
                        <path
                            d="M176 352c53.02 0 96-42.98 96-96V96c0-53.02-42.98-96-96-96S80 42.98 80 96v160c0 53.02 42.98 96 96 96zm160-160h-16c-8.84 0-16 7.16-16 16v48c0 74.8-64.49 134.82-140.79 127.38C96.71 376.89 48 317.11 48 250.3V208c0-8.84-7.16-16-16-16H16c-8.84 0-16 7.16-16 16v40.16c0 89.64 63.97 169.55 152 181.69V464H96c-8.84 0-16 7.16-16 16v16c0 8.84 7.16 16 16 16h160c8.84 0 16-7.16 16-16v-16c0-8.84-7.16-16-16-16h-56v-33.77C285.71 418.47 352 344.9 352 256v-48c0-8.84-7.16-16-16-16z">
                        </path>
                    </svg>
                </button>
            </div>
        </div>
    </div>

    <script src="./assets/js/chatbot/main.mjs"></script>
    <script type="module">
        const chat = new Chat('https://bot.chatpol.be/webhooks/rest/webhook')

        // clean teaxtarea on submit
        document.querySelector("#submit").addEventListener("click", function(event) {
            event.preventDefault();

            chat.sendMessage(document.getElementById("text").value);
            document.getElementById("text").value = ""

        }, false);

        // "Enter" key for sending message
        document.getElementById("text").addEventListener("keydown", function (event) {
            if (event.defaultPrevented) {
                return; // Ne devrait rien faire si l'événement de la touche était déjà consommé.
            }

            switch (event.key) {
                
                case "Enter":
                    document.getElementById("submit").click();
                break;

                default:
                    
                return; 
            }
            event.preventDefault();
        }, true);
    </script>

</body>

</html>